<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ucar.datalink.biz.dal.MediaSourceRelationDAO">

    <resultMap id="resultMap" type="mediaSourceRelation">
        <result property="id" column="id"/>
        <result property="virtualMsId" column="virtual_ms_id"/>
        <result property="realMsId" column="real_ms_id"/>
        <result property="createTime" column="create_time"/>
        <result property="modifyTime" column="modify_time"/>
    </resultMap>

    <sql id="allColumns">id,virtual_ms_id,real_ms_id,create_time,modify_time</sql>

    <select id="findList" resultMap="resultMap">
        SELECT
        <include refid="allColumns"/>
        FROM t_dl_mediasource_relation
    </select>

    <insert id="insert" parameterType="mediaSourceRelation" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO t_dl_mediasource_relation
        (virtual_ms_id,
        real_ms_id,
        create_time,
        modify_time
        )
        VALUE
        (#{virtualMsId},
        #{realMsId},
        now(),
        now()
        )
    </insert>

    <select id="checkExist" resultType="Integer" parameterType="mediaSourceRelation">
        SELECT
        COUNT(1)
        FROM t_dl_mediasource_relation
        WHERE 1=1
        <if test="virtualMsId != null">
            and virtual_ms_id = #{virtualMsId}
        </if>
        <if test="realMsId != null">
            and real_ms_id = #{realMsId}
        </if>
    </select>

    <select id="findListByVirtualId" resultMap="resultMap" parameterType="long">
        SELECT
        <include refid="allColumns"/>
        FROM t_dl_mediasource_relation
        WHERE virtual_ms_id=#{virtualMsId}
    </select>

    <delete id="delete" parameterType="mediaSourceRelation">
        DELETE FROM t_dl_mediasource_relation
        WHERE 1=1
        <if test="virtualMsId != null">
            and virtual_ms_id = #{virtualMsId}
        </if>
        <if test="realMsId != null">
            and real_ms_id = #{realMsId}
        </if>
    </delete>


    <select id="getOneByRealMsId" parameterType="Long" resultMap="resultMap">
        SELECT
        <include refid="allColumns"/>
        FROM t_dl_mediasource_relation where real_ms_id = #{realMsId}
    </select>

    <select id="checkExitOneByVritualMsId" parameterType="Long" resultType="Integer">
        SELECT
        count(1)
        FROM t_dl_mediasource_relation where virtual_ms_id = #{virtualId}
    </select>
</mapper>